webpackJsonp([14],{gCaP:function(e,t){},x50c:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("TToO"),n=o("7+uW"),l=o("c+8m"),a=o.n(l),i=o("RXoh"),s=o("EOM2"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=!1,t.checkboxGroup6=[],t.parentId=[""],t.departmentForm={},t.modelType="add",t.row={},t.currentObject={},t.filterText="",t.tableTree=[{id:1,label:"所有部门",value:"",children:{}}],t.defaultProps={children:"children",label:"label"},t.roleList=[],t.options=[],t}return r.b(t,e),t.prototype.watchCount=function(e,t){console.log("newVal",e,"oldVal",t),this.$refs.tree2.filter(e)},t.prototype.changeModel=function(e,t){var o=this;if(this.modelType=e,this.departmentForm={},this.checkboxGroup6=[],"edit"==e){var r={};Object.assign(r,t),this.departmentForm=r,this.row=t,t.roleList.forEach(function(e,t){o.checkboxGroup6.push(e.roleId)})}this.model=!0},t.prototype.doDelete=function(e,t){var o=this;this.$confirm("删除该部门？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.k({departmentId:t.departmentId}).then(function(e){e.retCode?(o.$message("已删除一条部门记录"),o.getDepartmentAllList(o.row.departmentId),o.getDepartment()):(e.islogin||o.$alert(e.message),console.error("数据查询错误"))})}).catch(function(){o.$message({type:"info",message:"已取消操作"})})},t.prototype.doSubmit=function(){var e=this;this.departmentForm.roleId=this.checkboxGroup6.join(","),"add"==this.modelType?i.c(this.departmentForm).then(function(t){t.retCode?(e.$message("保存成功"),e.getDepartment(),e.getDepartmentAllList(e.row.departmentId),e.model=!1):(t.islogin||e.$alert(t.message),console.error("数据查询错误"))}):i.h(this.departmentForm).then(function(t){t.retCode?(e.$message("保存成功"),e.getDepartment(),e.getDepartmentAllList(e.row.departmentId),e.model=!1):(t.islogin||e.$alert(t.message),console.error("数据查询错误"))})},t.prototype.filterNode=function(e,t){return!e||-1!==t.label.indexOf(e)},t.prototype.doNodeClick=function(e,t,o){this.row=e,this.getDepartmentAllList(e.departmentId)},t.prototype.roletoString=function(e){var t=[];return e.forEach(function(e,o){t.push(e.roleName)}),t.join(",")},t.prototype.getDepartmentAllList=function(e){var t=this;i.x({departmentId:e}).then(function(e){e.retCode?t.roleList=e.data.department:(e.islogin||t.$alert(e.message),console.error("数据查询错误"))})},t.prototype.getDepartment=function(){var e=this;i.w({}).then(function(t){console.log(t),t.retCode?(e.tableTree[0].children=t.data.children,console.log("获取部门树",t.data)):(t.islogin||e.$alert(t.message),console.error("数据查询错误"))})},t.prototype.getallRoleList=function(){var e=this;i.K({}).then(function(t){t.retCode?e.options=t.data.roleList:(t.islogin||e.$alert(t.message),console.error("数据查询错误"))})},t.prototype.mounted=function(){this.getDepartment(),this.getallRoleList(),this.getDepartmentAllList("")},r.a([Object(s.Watch)("filterText"),r.c("design:type",Function),r.c("design:paramtypes",[Object,Object]),r.c("design:returntype",void 0)],t.prototype,"watchCount",null),t=r.a([a()({props:{},components:{}})],t)}(n.default),d={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticStyle:{"border-bottom":"1px #e5e5e5 solid"}},[o("h3",[e._v("部门管理\n          ")]),e._v(" "),o("el-row",{staticStyle:{margin:"20px 20px 0","min-width":"180px"},attrs:{gutter:24}},[o("el-col",{attrs:{xs:24,sm:24,md:24,lg:7,xl:6}},[o("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{size:"mini",type:"primary"},on:{click:function(t){e.changeModel("add")}}},[e._v("添加部门")])],1)],1)],1),e._v(" "),o("el-row",{staticStyle:{margin:"10px"},attrs:{gutter:24}},[o("el-col",{attrs:{xs:24,sm:24,md:24,lg:7,xl:10}},[o("div",{staticStyle:{border:"solid 1px #e5e5e5",padding:"10px"}},[o("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),o("el-tree",{ref:"tree2",staticClass:"filter-tree",attrs:{data:e.tableTree,props:e.defaultProps,"expand-on-click-node":!1,"default-expand-all":"","highlight-current":"","filter-node-method":e.filterNode},on:{"node-click":e.doNodeClick}})],1)]),e._v(" "),o("el-col",{attrs:{xs:24,sm:24,md:24,lg:15,xl:14}},[o("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.roleList,stripe:""}},[o("el-table-column",{attrs:{prop:"name",label:"部门名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"parentName",label:"上级部门"}}),e._v(" "),o("el-table-column",{attrs:{label:"部门角色"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e.roletoString(t.row.roleList))+"\n      ")]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"TotalUserNum",label:"用户数量"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",fixed:"right",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{size:"mini",type:"primary"},on:{click:function(o){e.changeModel("edit",t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{size:"mini",type:"danger"},on:{click:function(o){e.doDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:e.model,width:"1050px",center:"",size:"tiny",title:"add"==e.modelType?"添加部门":"编辑部门","close-on-click-modal":!1,top:"40px"},on:{"update:visible":function(t){e.model=t}}},[o("el-form",{attrs:{"label-width":"120px"}},[o("el-form-item",{attrs:{label:"部门名称"}},[o("el-input",{staticStyle:{"max-width":"400px"},model:{value:e.departmentForm.name,callback:function(t){e.$set(e.departmentForm,"name",t)},expression:"departmentForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"上级部门"}},[o("el-cascader",{attrs:{options:e.tableTree,"change-on-select":""},model:{value:e.parentId,callback:function(t){e.parentId=t},expression:"parentId"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"角色名称"}},[o("div",[o("el-checkbox-group",{attrs:{size:"mini"},model:{value:e.checkboxGroup6,callback:function(t){e.checkboxGroup6=t},expression:"checkboxGroup6"}},e._l(e.options,function(t,r){return o("el-checkbox",{attrs:{label:t.roleId,border:""}},[e._v(e._s(t.roleName))])}))],1)])],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.model=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.doSubmit}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var p=o("VU/8")(c,d,!1,function(e){o("gCaP")},"data-v-489bc9b2",null);t.default=p.exports}});
//# sourceMappingURL=14.ba048d31e53deaeff05b.js.map