webpackJsonp([17],{Vt1u:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=o("TToO"),r=o("7+uW"),n=o("c+8m"),i=o.n(n),a=o("RXoh"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleForm={},e.checkboxGroup6=[],e.model=!1,e.modelType="add",e.roleList=[],e.keyword="",e.options=[],e.departmentId="",e.page=0,e.pageSize=10,e.total=100,e.allCount=0,e.AuthorityList=[],e}return l.b(e,t),e.prototype.handleDelete=function(t,e){var o=this;this.$confirm("此操作将删除该职位, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log(e),a.m({roleId:e.roleId}).then(function(t){t.retCode?(o.$message("删除成功"),o.getRoleList()):(t.islogin||o.$alert(t.message),console.error("数据查询错误"))})}).catch(function(){o.$message({type:"info",message:"已取消删除"})})},e.prototype.changeModel=function(t,e){if(this.modelType=t,this.roleForm={},e){var o={};Object.assign(o,e),this.roleForm=o,this.roleForm.role=this.roleForm.roleName,this.roleForm.description=this.roleForm.roleDescription,this.roleForm.role_id=this.roleForm.roleId}this.model=!0},e.prototype.doSubmit=function(){var t=this;console.log(this.modelType),"add"==this.modelType?a.a(this.roleForm).then(function(e){e.retCode?(t.$message("添加成功"),t.getRoleList(),t.model=!1):(e.islogin||t.$alert(e.message),console.error("数据查询错误"))}):a.O(this.roleForm).then(function(e){e.retCode?(t.$message("保存成功"),t.getRoleList(),t.model=!1):(e.islogin||t.$alert(e.message),console.error("数据查询错误"))})},e.prototype.onPageChange=function(t){this.page=t-1,this.getRoleList()},e.prototype.getRoleList=function(){var t=this,e="";this.departmentId.length>0&&(e=this.departmentId[this.departmentId.length-1]),a.K({keyword:this.keyword,departmentId:e,page:this.page,pageSize:this.pageSize}).then(function(e){e.retCode?(t.roleList=e.data.roleList,t.total=e.data.page.total):(e.islogin||t.$alert(e.message),console.error("数据查询错误"))})},e.prototype.getDepartment=function(){var t=this;a.w({}).then(function(e){console.log(e),e.retCode?(t.options=e.data.children,t.options.unshift({departmentId:"",label:"全部",name:"全部",value:""}),console.log("获取部门树",e.data)):(e.islogin||t.$alert(e.message),console.error("数据查询错误"))})},e.prototype.alloCount=function(){var t=this;a.d().then(function(e){console.log(e),e.retCode?t.allCount=e.data.num:(e.islogin||t.$alert(e.message),console.error("数据查询错误"))})},e.prototype.getPermission=function(){var t=this;a.B({}).then(function(e){e.retCode?(console.log("查询权限列表",e.data.AuthorityList),t.AuthorityList=e.data.AuthorityList):(e.islogin||t.$alert(e.message),console.error("数据查询错误"))})},e.prototype.mounted=function(){this.alloCount(),this.getRoleList(),this.getDepartment(),this.getPermission()},e=l.a([i()({props:{},components:{}})],e)}(r.default),c={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticStyle:{"border-bottom":"1px #e5e5e5 solid"}},[o("h3",[t._v("职位管理\n          ")]),t._v(" "),o("div",{staticStyle:{margin:"10px 0"}},[t._v("\n平台职位数量统计："+t._s(t.allCount)+"             \n            ")]),t._v(" "),o("div",{staticStyle:{"padding-bottom":"20px"}},[o("el-row",{attrs:{gutter:10}},[o("el-col",{attrs:{xs:8,sm:8,md:5,lg:5,xl:4}},[o("el-cascader",{staticStyle:{"margin-top":"20px"},attrs:{options:t.options},model:{value:t.departmentId,callback:function(e){t.departmentId=e},expression:"departmentId"}})],1),t._v(" "),o("el-col",{attrs:{xs:8,sm:8,md:5,lg:5,xl:5}},[o("el-input",{staticStyle:{"margin-top":"20px"},attrs:{placeholder:"请输入职位名称",clearable:""},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),t._v(" "),o("el-col",{staticStyle:{"min-width":"100px"},attrs:{xs:5,sm:5,md:2,lg:2,xl:2}},[o("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){t.getRoleList()}}},[t._v("查询")])],1),t._v(" "),o("el-col",{attrs:{xs:5,sm:5,md:2,lg:2,xl:2}},[o("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:function(e){t.changeModel("add")}}},[t._v("添加职位")])],1)],1)],1)]),t._v(" "),o("el-table",{staticStyle:{width:"100%","min-height":"500px"},attrs:{border:"",data:t.roleList,stripe:""}},[o("el-table-column",{attrs:{prop:"name",label:"部门名称"}}),t._v(" "),o("el-table-column",{attrs:{prop:"parentName",label:"上级部门"}}),t._v(" "),o("el-table-column",{attrs:{prop:"roleName",label:"职位名称"}}),t._v(" "),o("el-table-column",{attrs:{prop:"roleDescription",label:"职位描述"}}),t._v(" "),o("el-table-column",{attrs:{prop:"userNum",label:"用户数量"}}),t._v(" "),o("el-table-column",{attrs:{label:"职位状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tag",{attrs:{type:e.row.roleAvailable?"success":"info"}},[t._v("\n               "+t._s(e.row.roleAvailable?"启用中":"已停用"))])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"操作",fixed:"right",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(o){t.changeModel("edit",e.row)}}},[t._v("编辑")]),t._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){t.handleDelete(e.$index,e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),o("el-col",{staticClass:"toolbar",attrs:{span:24}},[o("el-pagination",{attrs:{layout:"prev, pager, next","page-size":t.pageSize,total:t.total},on:{"current-change":t.onPageChange}})],1),t._v(" "),o("el-dialog",{attrs:{visible:t.model,width:"1050px",center:"",size:"tiny",title:"add"==t.modelType?"添加职位":"编辑职位","close-on-click-modal":!1,top:"40px"},on:{"update:visible":function(e){t.model=e}}},[o("el-form",{attrs:{"label-width":"120px"}},[o("el-form-item",{attrs:{label:"职位名称"}},[o("el-input",{staticStyle:{"max-width":"400px"},model:{value:t.roleForm.role,callback:function(e){t.$set(t.roleForm,"role",e)},expression:"roleForm.role"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"职位描述"}},[o("el-input",{staticStyle:{"max-width":"400px"},model:{value:t.roleForm.description,callback:function(e){t.$set(t.roleForm,"description",e)},expression:"roleForm.description"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"权限"}},[o("div",[o("el-checkbox-group",{attrs:{size:"mini"},model:{value:t.checkboxGroup6,callback:function(e){t.checkboxGroup6=e},expression:"checkboxGroup6"}},t._l(t.AuthorityList,function(e,l){return o("el-checkbox",{attrs:{label:e.permissionId,border:""}},[t._v(t._s(e.name))])}))],1)])],1),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.model=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.doSubmit}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var p=o("VU/8")(s,c,!1,function(t){o("uPyg")},"data-v-41e6751b",null);e.default=p.exports},uPyg:function(t,e){}});
//# sourceMappingURL=17.c993d3bc7aaf9a4970dd.js.map